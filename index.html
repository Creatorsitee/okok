<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   GoCloud - Deploy
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <style>
   body { font-family: 'Inter', sans-serif; }
   /* Animations for popup */
   @keyframes fadeInScale {
     0% {
       opacity: 0;
       transform: scale(0.9);
     }
     100% {
       opacity: 1;
       transform: scale(1);
     }
   }
   @keyframes fadeOutScale {
     0% {
       opacity: 1;
       transform: scale(1);
     }
     100% {
       opacity: 0;
       transform: scale(0.9);
     }
   }
   .animate-fade-in-scale {
     animation: fadeInScale 0.3s ease-out forwards;
   }
   .animate-fade-out-scale {
     animation: fadeOutScale 0.3s ease-out forwards;
   }
   /* Animation for scroll-triggered elements */
   .reveal {
     opacity: 0;
     transform: translateY(30px);
     transition: opacity 0.6s ease-out, transform 0.6s ease-out;
   }
   .reveal.visible {
     opacity: 1;
     transform: translateY(0);
   }
   /* Prevent scrolling on body when popup is open */
   body.popup-open {
     overflow: hidden;
     height: 100vh;
   }
  </style>
 </head>
 <body class="bg-gradient-to-b from-indigo-50 to-white min-h-screen flex flex-col">
  <header class="bg-white shadow-md sticky top-0 z-30">
   <div class="max-w-6xl mx-auto px-6 py-5 flex items-center justify-between">
    <a class="flex items-center space-x-3" href="#">
     <img alt="Logo" class="w-10 h-10 rounded-md" src="https://raw.githubusercontent.com/codegood21/file/refs/heads/main/h6g3ve.png"/>
     <h1 class="text-2xl font-extrabold text-indigo-600 tracking-wide">
      GoCloud
     </h1>
    </a>
    <nav class="hidden md:flex space-x-8 text-gray-600 font-medium">
     <a class="hover:text-indigo-600 transition duration-300" href="#">
      Home
     </a>
     <a class="hover:text-indigo-600 transition duration-300" href="#">
      About
     </a>
     <a class="hover:text-indigo-600 transition duration-300" href="#">
      Contact
     </a>
    </nav>
    <div aria-label="Battery status" class="md:hidden flex items-center space-x-2 text-indigo-600 font-semibold" id="batteryStatus">
     <i aria-hidden="true" class="fas fa-battery-full fa-lg" id="batteryIcon">
     </i>
     <span class="text-base select-none" id="batteryLevelText">
      --%
     </span>
    </div>
   </div>
  </header>
  <main class="flex-grow max-w-4xl mx-auto px-6 py-12 w-full relative">
   <section class="bg-white rounded-2xl shadow-lg p-10 md:p-14 max-w-3xl mx-auto">
    <div class="mb-10">
     <h2 class="text-3xl font-extrabold text-gray-900 mb-4 text-center">
      GoCloud
     </h2>
     <p class="text-gray-600 max-w-xl mx-auto text-center">
      Activate Your Website Now In Seconds!
     </p>
    </div>
    <form class="space-y-8" enctype="multipart/form-data" id="deployForm" novalidate="">
     <div>
      <label class="block text-gray-700 font-semibold mb-3" for="domain">
       Project Name
      </label>
      <input class="w-full border border-gray-300 rounded-lg px-5 py-3 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" id="domain" name="domain" placeholder="project-name" required="" type="text"/>
      <p class="text-sm text-red-600 mt-2 hidden" id="domainError">
       Project Name Hang Di Gunakan Untuk Subdomain hanya boleh huruf kecil, angka, strip (-), min 3 karakter.
      </p>
     </div>
     <div>
      <label class="block text-gray-700 font-semibold mb-3" for="file">
       Upload Script
      </label>
      <label for="file" class="inline-block border border-gray-300 rounded-lg px-4 py-2 bg-indigo-50 text-indigo-600 font-semibold cursor-pointer hover:bg-indigo-100 transition">
       Choose File
      </label>
      <input type="file" id="file" name="file" accept=".html,.zip" class="hidden" required>
      <span id="fileName" class="ml-2 text-gray-500">
       No file
      </span>
      <p class="text-sm text-red-600 mt-2 hidden" id="fileError">
       Files must be in HTML or ZIP format.
      </p>
     </div>
     <button class="w-full md:w-auto inline-flex items-center justify-center bg-indigo-600 text-white font-semibold px-8 py-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-offset-2 transition" id="submitBtn" type="submit">
      <i class="fas fa-cloud-upload-alt mr-3 text-lg">
      </i>
      Deploy
     </button>
     <div class="hidden text-center mt-4" id="loadingSpinner">
      <svg class="animate-spin h-8 w-8 text-indigo-600 mx-auto" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
       <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
       </circle>
       <path class="opacity-75" d="M4 12a8 8 0 018-8v8H4z" fill="currentColor">
       </path>
      </svg>
      <p class="text-indigo-600 mt-2 font-medium">
       Please wait...
      </p>
     </div>
    </form>
   </section>
   <section class="mt-20 max-w-3xl mx-auto px-6">
    <h3 class="text-2xl font-extrabold text-gray-900 mb-10 text-center">
     How It Works
    </h3>
    <div class="space-y-8 md:space-y-0 md:grid md:grid-cols-3 md:gap-8 text-center">
     <div class="bg-white rounded-xl shadow-md p-8 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 reveal">
      <div class="bg-indigo-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-5">
       <i class="fas fa-edit text-3xl text-indigo-600">
       </i>
      </div>
      <h4 class="text-lg font-semibold mb-2 text-indigo-600">
       Enter Project Name
      </h4>
      <p class="text-gray-600 text-sm">
       Enter your project name. This name will be used as the URL.
      </p>
     </div>
     <div class="bg-white rounded-xl shadow-md p-8 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 reveal">
      <div class="bg-indigo-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-5">
       <i class="fas fa-file-upload text-3xl text-indigo-600">
       </i>
      </div>
      <h4 class="text-lg font-semibold mb-2 text-indigo-600">
       Upload Your Script
      </h4>
      <p class="text-gray-600 text-sm">
       Upload your website files in HTML or ZIP format safely.
      </p>
     </div>
     <div class="bg-white rounded-xl shadow-md p-8 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 reveal">
      <div class="bg-indigo-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-5">
       <i class="fas fa-rocket text-3xl text-indigo-600">
       </i>
      </div>
      <h4 class="text-lg font-semibold mb-2 text-indigo-600">
       Go Live Instantly
      </h4>
      <p class="text-gray-600 text-sm">
       Your website is immediately active and can be accessed via a subdomain.
      </p>
     </div>
    </div>
   </section>
  </main>
  <footer class="bg-white border-t border-indigo-100 mt-20">
   <div class="max-w-6xl mx-auto px-6 py-8 flex flex-col md:flex-row items-center justify-between text-gray-500 text-sm">
    <p>
     ï¿½ 2025 GoCloud. All rights reserved.
    </p>
    <div class="flex space-x-6 mt-4 md:mt-0 text-xl">
     <a aria-label="Instagram" class="hover:text-indigo-600 transition" href="https://www.instagram.com/baguselek21" rel="noopener noreferrer" target="_blank">
      <i class="fab fa-instagram">
      </i>
     </a>
     <a aria-label="TikTok" class="hover:text-indigo-600 transition" href="https://www.tiktok.com/@cogood27" rel="noopener noreferrer" target="_blank">
      <i class="fab fa-tiktok">
      </i>
     </a>
     <a aria-label="Telegram" class="hover:text-indigo-600 transition" href="https://t.me/baguscpanel" rel="noopener noreferrer" target="_blank">
      <i class="fab fa-telegram-plane">
      </i>
     </a>
    </div>
   </div>
  </footer>
  <div aria-modal="true" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden" id="popupModal" role="dialog">
   <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 text-center relative animate-fade-in-scale" id="popupContentWrapper">
    <button aria-label="Close popup" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 focus:outline-none" id="closePopup" type="button">
     <i class="fas fa-times">
     </i>
    </button>
    <div class="w-full" id="popupContent">
     </div>
   </div>
  </div>
  <div aria-modal="true" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden" id="welcomeModal" role="dialog">
   <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-8 text-center relative animate-fade-in-scale">
    <button aria-label="Close popup" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 focus:outline-none" id="closeWelcomePopup" type="button">
     <i class="fas fa-times fa-lg">
     </i>
    </button>
    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-indigo-100 mb-5">
     <i class="fas fa-bullhorn text-3xl text-indigo-600">
     </i>
    </div>
    <h3 class="text-2xl font-extrabold text-gray-900">
     Welcome to GoCloud!
    </h3>
    <p class="text-gray-600 mt-3">
     Join our Telegram channel for the latest updates, news, and support.
    </p>
    <a class="w-full mt-6 inline-flex items-center justify-center bg-indigo-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-offset-2 transition" href="https://t.me/baguscpanel" id="joinChannelBtn" rel="noopener noreferrer" target="_blank">
     <i class="fab fa-telegram-plane mr-2">
     </i>
     Join Channel
    </a>
   </div>
  </div>
  <script>
   document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('deployForm');
    const domainInput = document.getElementById('domain');
    const fileInput = document.getElementById('file');
    const domainError = document.getElementById('domainError');
    const fileError = document.getElementById('fileError');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const submitBtn = document.getElementById('submitBtn');

    const popupModal = document.getElementById('popupModal');
    const popupContent = document.getElementById('popupContent');
    const popupContentWrapper = document.getElementById('popupContentWrapper');
    const closePopup = document.getElementById('closePopup');

    const batteryIcon = document.getElementById('batteryIcon');
    const batteryLevelText = document.getElementById('batteryLevelText');
    const fileNameText = document.getElementById('fileName');

    const welcomeModal = document.getElementById('welcomeModal');
    const closeWelcomePopup = document.getElementById('closeWelcomePopup');
    const joinChannelBtn = document.getElementById('joinChannelBtn');


    // --- Welcome Popup Logic ---
    if (!sessionStorage.getItem('welcomePopupShown')) {
        setTimeout(() => {
            welcomeModal.classList.remove('hidden');
            document.body.classList.add('popup-open');
        }, 1500);
    }

    function closeWelcomeModal() {
        const wrapper = welcomeModal.querySelector('.animate-fade-in-scale');
        wrapper.classList.remove('animate-fade-in-scale');
        wrapper.classList.add('animate-fade-out-scale');
        wrapper.addEventListener('animationend', () => {
            welcomeModal.classList.add('hidden');
            if (popupModal.classList.contains('hidden')) {
               document.body.classList.remove('popup-open');
            }
        }, { once: true });
        sessionStorage.setItem('welcomePopupShown', 'true');
    }

    closeWelcomePopup.addEventListener('click', closeWelcomeModal);
    joinChannelBtn.addEventListener('click', closeWelcomeModal);
    welcomeModal.addEventListener('click', (e) => {
      if (e.target === welcomeModal) {
        closeWelcomeModal();
      }
    });

    // --- File Input Name Display ---
    fileInput.addEventListener('change', function() {
      fileNameText.textContent = this.files.length ? this.files[0].name : 'No file';
    });

    // --- Battery Status Logic ---
    if ('getBattery' in navigator) {
      navigator.getBattery().then(battery => {
        const updateBatteryIcon = (level, charging) => {
          const percentage = Math.round(level * 100);
          batteryLevelText.textContent = `${percentage}%`;
          batteryIcon.className = 'fas fa-lg';
          if (charging) {
            batteryIcon.classList.add('fa-bolt', 'text-indigo-600');
          } else if (percentage <= 10) {
            batteryIcon.classList.add('fa-battery-empty', 'text-red-600');
          } else if (percentage <= 35) {
            batteryIcon.classList.add('fa-battery-quarter', 'text-red-600');
          } else if (percentage <= 60) {
            batteryIcon.classList.add('fa-battery-half', 'text-yellow-500');
          } else if (percentage <= 85) {
            batteryIcon.classList.add('fa-battery-three-quarters', 'text-green-600');
          } else {
            batteryIcon.classList.add('fa-battery-full', 'text-green-600');
          }
        };
        const updateAllBatteryInfo = () => updateBatteryIcon(battery.level, battery.charging);
        updateAllBatteryInfo();
        battery.addEventListener('levelchange', updateAllBatteryInfo);
        battery.addEventListener('chargingchange', updateAllBatteryInfo);
      }).catch(() => { batteryIcon.className = 'fas fa-battery-half text-gray-400'; });
    } else {
      batteryIcon.className = 'fas fa-battery-half text-gray-400';
    }

    // --- Result Popup Logic ---
    function closePopupWithAnimation() {
      popupContentWrapper.classList.remove('animate-fade-in-scale');
      popupContentWrapper.classList.add('animate-fade-out-scale');
      popupContentWrapper.addEventListener('animationend', () => {
        popupModal.classList.add('hidden');
        document.body.classList.remove('popup-open');
      }, { once: true });
    }

    closePopup.addEventListener('click', closePopupWithAnimation);
    popupModal.addEventListener('click', (e) => {
      if (e.target === popupModal) {
        closePopupWithAnimation();
      }
    });

    // --- Form Validation ---
    const validateDomain = (domain) => /^[a-z0-9-]{3,64}$/.test(domain);
    const validateFile = (file) => file && ['.html', '.zip'].some(ext => file.name.toLowerCase().endsWith(ext));

    // --- Form Submission Logic ---
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      domainError.classList.add('hidden');
      fileError.classList.add('hidden');

      const domain = domainInput.value.trim().toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
      const file = fileInput.files[0];
      let valid = true;

      if (!validateDomain(domain)) { 
        domainError.classList.remove('hidden'); 
        valid = false; 
      }
      if (!validateFile(file)) { 
        fileError.classList.remove('hidden'); 
        valid = false; 
      }
      if (!valid) return;

      const formData = new FormData();
      formData.append('subdomain', domain);
      formData.append('file', file, file.name.endsWith('.zip') ? 'project.zip' : 'index.html');

      loadingSpinner.classList.remove('hidden');
      submitBtn.disabled = true;

      try {
        const response = await fetch('https://ojihosting.vercel.app/deploy.html', {
          method: 'POST',
          body: formData
        });

        // FIX: Check if response is JSON first
        const responseText = await response.text();
        let json;
        
        try {
          json = JSON.parse(responseText);
        } catch (parseError) {
          throw new Error(`Server error: ${responseText.substring(0, 100)}`);
        }

        if (!json.success) {
          throw new Error(json.message || 'Deployment failed.');
        }

        const deployedUrl = `${json.url}`;
        const qrApiUrl = `https://apii.baguss.web.id/tools/toqr?apikey=bagus&text=${encodeURIComponent(deployedUrl)}`;
        
        popupContentWrapper.classList.remove('animate-fade-out-scale');
        popupContentWrapper.classList.add('animate-fade-in-scale');
        
        // SUCCESS POPUP WITH QR CODE
        popupContent.innerHTML = `
          <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100">
             <i class="fas fa-check text-2xl text-green-600"></i>
          </div>
          <div class="mt-3 text-center sm:mt-5">
            <h3 class="text-lg leading-6 font-bold text-gray-900">Successful!</h3>
            <div class="mt-4">
               <img src="${qrApiUrl}" alt="QR code for ${deployedUrl}" class="w-32 h-32 rounded-lg border-2 border-gray-200 shadow-sm mx-auto"/>
               <div class="relative rounded-md shadow-sm mt-4">
                   <input type="text" id="deployedUrl" readonly value="${deployedUrl}" class="block w-full rounded-md border-gray-300 bg-gray-100 text-sm p-2 text-center text-gray-600 focus:ring-0 focus:border-gray-300" style="word-break: break-all;">
               </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">Site is live in 1-5 mins.</p>
          </div>
          <div class="mt-5 sm:mt-6">
            <button type="button" id="copyUrlBtn" class="inline-flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:text-sm">
              Copy Link
            </button>
          </div>
        `;
        
        document.getElementById('copyUrlBtn').addEventListener('click', (e) => {
            const urlInput = document.getElementById('deployedUrl');
            const copyBtn = e.currentTarget;
            navigator.clipboard.writeText(urlInput.value).then(() => {
                copyBtn.textContent = 'Copied!';
                copyBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                copyBtn.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                setTimeout(() => {
                    copyBtn.textContent = 'Copy Link';
                    copyBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                    copyBtn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                }, 2000);
            });
        });

      } catch (error) {
        popupContentWrapper.classList.remove('animate-fade-out-scale');
        popupContentWrapper.classList.add('animate-fade-in-scale');
        
        popupContent.innerHTML = `
          <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
            <i class="fas fa-times text-2xl text-red-600"></i>
          </div>
          <div class="mt-3 text-center sm:mt-5">
            <h3 class="text-lg leading-6 font-bold text-gray-900">An Error Occurred</h3>
            <div class="mt-2">
              <p class="text-sm text-gray-600 break-words">${error.message}</p>
            </div>
          </div>
        `;
      } finally {
        popupModal.classList.remove('hidden');
        document.body.classList.add('popup-open');
        loadingSpinner.classList.add('hidden');
        submitBtn.disabled = false;
        form.reset();
        fileNameText.textContent = 'No file';
      }
    });

    // --- "How It Works" Scroll Animation ---
    const revealElements = document.querySelectorAll('.reveal');
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });

    revealElements.forEach((el, index) => {
      el.style.transitionDelay = `${index * 150}ms`;
      revealObserver.observe(el);
    });

   });
  </script>
 </body>
</html>
